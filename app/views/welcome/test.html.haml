%div{style: 'width: 800px;'}
  #map{style: 'width: 800px; height: 800px;'}
  
  
:javascript
  $(document).ready(function(){
    var handler = Gmaps.build('Google');
    handler.buildMap({ provider: { zoom: 16}, internal: {id: 'map'}}, function(){
      var markers = handler.addMarkers(#{raw @json.to_json});
      handler.bounds.extendWith(markers);
      if (window.navigator.geolocation) {
        var failure, success;
        success = function(position) {
          handler.map.centerOn({ lat: position.coords.latitude, lng: position.coords.longitude });  
        };
        failure = function(message) {
          alert('Cannot retrieve location!');
        };
        navigator.geolocation.getCurrentPosition(success, failure, {
          maximumAge: Infinity,
          timeout: 5000
        }); 
      }
    });
  }); 
